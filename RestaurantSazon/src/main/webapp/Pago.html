<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Confirmar Pedido</title>
<style>
  /* Reset básico */
  * {
    box-sizing: border-box;
  }

  body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: url('Imagenes/fondo.png') no-repeat center center fixed;
    background-size: cover;
    color: #5d2c00;
  }

  /* Fondo decorativo fijo */
  .fondo {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    z-index: -1;
  }

  /* Barra superior */
  .top-bar {
    width: 100%;
    height: 35px;
    background-color: rgba(255, 165, 0, 0.5);
    border-radius: 0 0 10px 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 20px;
    position: fixed;
    top: 0; left: 0;
    font-family: 'Akhbar MT', sans-serif;
    z-index: 1000;
  }

  .restaurant-title {
    font-size: 18px;
    font-weight: bold;
    color: white;
    margin: 0;
  }

  .menu-container {
    display: flex;
    gap: 15px;
  }
.top-bar select {
  background-color: rgba(255, 165, 0, 0.8); 
  color: white; 
  border: none;
  font-weight: bold;
  padding: 4px 8px;
  border-radius: 4px;
  cursor: pointer;
}

.top-bar select:focus {
  outline: none;
  border: 1px solid #fff;
}
  .menu-item {
    position: relative;
    color: white;
    font-weight: bold;
    cursor: pointer;
    font-size: 14px;
    padding: 5px 10px;
    border-radius: 4px;
    transition: background 0.3s;
  }

  .menu-item:hover {
    background-color: rgba(255, 255, 255, 0.2);
  }

  .submenu-parent {
    position: relative;
  }

  .submenu {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    background-color: rgba(255, 165, 0, 0.8);
    border-radius: 5px;
    padding: 5px 0;
    z-index: 1100;
    min-width: 150px;
  }

  .submenu-item {
    padding: 8px 12px;
    color: white;
    font-weight: bold;
    cursor: pointer;
    font-size: 14px;
  }

  .submenu-item:hover {
    background-color: rgba(255, 255, 255, 0.2);
  }

  .submenu-parent:hover .submenu {
    display: block;
  }

  /* Contenido principal */
  main {
    margin: 90px auto 40px;
    max-width: 600px;
    background: rgba(255 255 255 / 0.5);
    border-radius: 15px;
    padding: 30px 40px;
    box-shadow: 0 0 25px rgba(0,0,0,0.2);
    color: #b96300;
  }

  main h1 {
    text-align: center;
    margin-bottom: 25px;
    font-size: 28px;
    color: #b96300;
  }

  .platillo {
    display: flex;
    justify-content: space-between;
    margin-bottom: 12px;
    font-size: 18px;
  }

  label {
    display: block;
    margin-top: 20px;
    font-weight: bold;
    font-size: 16px;
  }

  input[type="text"], select {
    width: 100%;
    padding: 12px 15px;
    margin-top: 8px;
    font-size: 16px;
    border-radius: 8px;
    border: 1px solid #ccc;
    outline: none;
    transition: border-color 0.3s;
  }

  input[type="text"]:focus, select:focus {
    border-color: #ffa500;
  }

  .error {
    color: red;
    font-size: 14px;
    margin-top: 6px;
    display: none;
  }

  .info-metodo {
    font-style: italic;
    font-size: 14px;
    margin-top: 10px;
    color: #6e4700;
  }

  .total {
    margin-top: 30px;
    font-size: 22px;
    font-weight: bold;
    text-align: right;
  }

  #confirmar {
    display: block;
    margin: 35px auto 0;
    padding: 14px 40px;
    background: #EBAF5D;
    color: white;
    font-size: 20px;
    border: none;
    border-radius: 15px;
    cursor: pointer;
    font-weight: bold;
    transition: background 0.3s;
  }

  #confirmar:hover {
    background: #d99845;
  }

  @media (max-width: 650px) {
    main {
      margin: 100px 20px 40px;
      padding: 25px;
    }
  }
</style>
</head>
<body>

  <div class="fondo"></div>

  <header class="top-bar">
    <div class="restaurant-title">El Sazón de Cantera y Plata</div>
    <div class="menu">
	  <select id="registroSelect" onchange="redirigir()">
	    <option selected disabled>Regístrate</option>
	    <option value="usuario">Usuario</option>
	    <option value="personal">Personal</option>
	    <option value="admin">Administrador</option>
	  </select>
	  </div>
  </header>

  <main>
  <h1>Confirma tu pedido</h1>

  <div id="listaPlatillos">
    <!-- Aquí se agregarán los platillos del carrito -->
  </div>

  <label for="direccion">Dirección de entrega:</label>
  <input type="text" id="direccion" placeholder="Ej: Calle 123, #45-B" />
  <p id="errorDireccion" class="error">⚠ La dirección es muy corta o inválida.</p>

  <label for="metodoPago">Método de pago:</label>
  <select id="metodoPago">
    <option disabled selected>Selecciona uno</option>
    <option>Efectivo</option>
    <option>Tarjeta de débito</option>
    <option>Tarjeta de crédito</option>
    <option>Transferencia bancaria</option>
  </select>
  <p id="infoMetodoPago" class="info-metodo"></p>

  <p class="total" id="totalPedido">Total: $0.00</p>

  <button id="confirmar">Confirmar pedido</button>
</main>


<script>
function mostrarCarrito() {
	  const lista = document.getElementById("listaPlatillos");
	  const totalPedido = document.getElementById("totalPedido");

	  // Obtener carrito desde localStorage
	  const carrito = JSON.parse(localStorage.getItem("carrito")) || [];

	  if (carrito.length === 0) {
	    lista.innerHTML = "<p>No hay productos en el carrito.</p>";
	    totalPedido.textContent = "Total: $0.00";
	    return;
	  }

	  lista.innerHTML = "";
	  let total = 0;

	  carrito.forEach(item => {
	    // Usar propiedades en inglés según tu carrito
	    const precio = parseFloat(item.price);
	    const cantidad = parseInt(item.quantity);

	    if (!item.name || isNaN(precio) || isNaN(cantidad)) {
	      console.warn("Item inválido en carrito:", item);
	      return;
	    }

	    const subtotal = precio * cantidad;
	    total += subtotal;

	    const divPlatillo = document.createElement("div");
	    divPlatillo.classList.add("platillo");
	    divPlatillo.innerHTML = `<span>${cantidad}x ${item.name}</span><span>$${subtotal.toFixed(2)}</span>`;
	    lista.appendChild(divPlatillo);
	  });

	  totalPedido.textContent = `Total: $${total.toFixed(2)}`;
	}

	document.getElementById("metodoPago").addEventListener("change", function() {
	  const val = this.value;
	  let msg = "";
	  if(val === "Efectivo") msg = "Recuerda tener el monto exacto al momento de la entrega.";
	  else if(val === "Tarjeta de débito") msg = "El repartidor llevará una terminal para el cobro.";
	  else if(val === "Tarjeta de crédito") msg = "Aceptamos todas las tarjetas principales.";
	  else if(val === "Transferencia bancaria") msg = "Recibirás instrucciones para transferir.";
	  document.getElementById("infoMetodoPago").textContent = msg;
	});

	document.getElementById("confirmar").addEventListener("click", () => {
	  const direccion = document.getElementById("direccion").value.trim();
	  const metodoPago = document.getElementById("metodoPago").value;
	  const errorDireccion = document.getElementById("errorDireccion");

	  errorDireccion.style.display = direccion.length < 10 ? "block" : "none";
	  if (direccion.length < 10) return;

	  if (!metodoPago || metodoPago === "Selecciona uno") {
	    alert("Por favor selecciona un método de pago.");
	    return;
	  }
	  

	  // Confirmar pedido y limpiar carrito
	  alert(`Pedido confirmado!\nDirección: ${direccion}\nPago: ${metodoPago}\nTotal: ${document.getElementById("totalPedido").textContent.replace("Total: ", "")}`);

	  localStorage.removeItem("carrito");

	  // Redirigir a página principal o agradecimiento
	  window.location.href = "Despedida.html";
	});

	// Ejecutar al cargar la página
	document.addEventListener("DOMContentLoaded", mostrarCarrito);

</script>

</body>
</html>
